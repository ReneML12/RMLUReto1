name: Listar repos de mi cuenta + ramas

on:
  workflow_dispatch:

jobs:
  list:
    runs-on: ubuntu-latest
    env:
      TOKEN: ${{ secrets.PAT_TOKEN }}
    steps:
      - name: Obtener todos los repositorios
        run: |
          curl -s -H "Authorization: token $TOKEN" \
            "https://api.github.com/user/repos?per_page=100" > repos.json
          echo "üì¶ REPOSITORIOS ENCONTRADOS:"
          cat repos.json | jq -r '.[] | "‚û°Ô∏è \(.full_name) | Creado: \(.created_at) | Privado: \(.private)"'

      - name: Listar ramas por cada repo
        run: |
          for repo in $(jq -r '.[].full_name' repos.json); do
            echo "-----"
            echo "Repositorio: $repo"
            # Obtener ramas via API
            curl -s -H "Authorization: token $TOKEN" \
              "https://api.github.com/repos/$repo/branches?per_page=100" \
              | jq -r '.[].name' \
              | sed 's/^/  - /'
          done
